document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("tel");if(e){e.setAttribute("maxlength","18");const n=e=>{const s=e.replace(/\D/g,"").slice(0,11);let n="",t=s;return s.length>10&&s.startsWith("1")?(n="+1 ",t=s.slice(1)):e.trim().startsWith("+1")&&(n="+1 ",t=s.replace(/^1/,"")),t.length===0?n:t.length<4?`${n}(${t}`:t.length<7?`${n}(${t.slice(0,3)}) ${t.slice(3)}`:`${n}(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`},t=()=>{const s=e.value,t=n(s);if(t!==s){const n=t.length;e.value=t,requestAnimationFrame(()=>{try{e.setSelectionRange(n,n)}catch{}})}};e.addEventListener("input",t),e.addEventListener("blur",t),e.addEventListener("paste",()=>requestAnimationFrame(t))}const t=document.getElementById("contactForm");if(t){const s="roks_cart_v1",e=30*24*60*60*1e3,o=()=>{try{const n=localStorage.getItem(s);if(!n)return{items:[],expiresAt:Date.now()+e};const t=JSON.parse(n);return!t.expiresAt||t.expiresAt<Date.now()?(localStorage.removeItem(s),{items:[],expiresAt:Date.now()+e}):(Array.isArray(t.items)||(t.items=[]),t)}catch{return{items:[],expiresAt:Date.now()+e}}},i=()=>document.body&&document.body.dataset.currency||"$",n=e=>`${i()}${(Number(e)||0).toFixed(2)}`,a=e=>{const t=Array.isArray(e.items)?e.items:[];if(t.length===0)return"";let s=0;const o=t.map((e,t)=>{const o=Number(e.qty)||0,i=Number(e.price)||0,a=o*i;s+=a;const r=e.variantName?` — ${e.variantName}`:"";return`${t+1}) ${e.title}${r} × ${o} @ ${n(i)} = ${n(a)}`});return`--- Cart Summary ---

${o.join(`

`)}
Total: ${n(s)}`};t.addEventListener("submit",e=>{e.preventDefault();const s=new FormData(t),r=o(),i=a(r);i&&s.append("cart",i);const n=t.querySelector('button[type="submit"]');n&&(n.disabled=!0),fetch("https://smartforms.dev/submit/68b113e4c184545ccc0c85b2",{method:"POST",body:s,headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(e=>{if(!e.ok)throw new Error("Bad response")}).then(()=>{t.reset(),window.location.href="/contact/success/"}).catch(()=>{alert("Sorry, there was a problem sending your message. Please try again.")}).finally(()=>{n&&(n.disabled=!1)})})}})